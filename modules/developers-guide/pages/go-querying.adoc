== Go querying

A simple query can be performed by passing a CQL query to the client:

[source, go]
----
go
query := &pb.Query{
    Cql: "select cluster_name from system.local",
}

response, err := stargateClient.ExecuteQuery(query)
----

Data definition (DDL) queries are supported in the same manner:

[source, go]
----
go
// Create a new keyspace
createKeyspaceStatement := &pb.Query{
    Cql: "CREATE KEYSPACE IF NOT EXISTS ks1 WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor' : 1};",
}
_, err = stargateClient.ExecuteQuery(createKeyspaceStatement)
if err != nil {
    return err
}

// Create a new table
createTableStatement := `
   CREATE TABLE IF NOT EXISTS ks1.tbl2 (
     key text PRIMARY KEY,
     value text
   );`
createTableQuery := &pb.Query{
	Cql: createTableStatement,
}

_, err = stargateClient.ExecuteQuery(createTableQuery)
if err != nil {
    return err
}
----

Parameterized queries are also supported:

[source, go]
----
go
any, err := anypb.New(
    &pb.Values{
        Values: []*pb.Value{
            {
                Inner: &pb.Value_String_{
                    String_: "system",
                },
            },
        },
    },
)
if err != nil {
	return err
}

query := &pb.Query{
    Cql: "select * from system_schema.keyspaces where keyspace_name = ?",
    Values: &pb.Payload{
        Type: pb.Payload_CQL,
        Data: any,
    },
    Parameters: &pb.QueryParameters{
        Tracing:      false,
        SkipMetadata: false,
    },
}
response, err := stargateClient.ExecuteQuery(query)
----

If you would like to use a link:https://cassandra.apache.org/doc/latest/cassandra/cql/dml.html#batch_statement[batch statement],
the client also provides an `executeBatch()` function for this purpose:

[source, go]
----
go
batch := &pb.Batch{
    Type:       pb.Batch_LOGGED,
    Queries:    []*pb.BatchQuery{
        {
            Cql: "insert into ks1.tbl2 (key, value) values ('a', 'alpha');",
        },
        {
            Cql: "insert into ks1.tbl2 (key, value) values ('b', 'bravo');",
        },
    },
}

response, err := stargateClient.ExecuteBatch(batch)
----
