= Stargate Concepts

Stargate is a framework that can be used to customize of all aspects of data access.
It is meant to be deployed between client applications and a database to provide
an abstraction layer that can be used to shape your data access to the form that
best fits you and your application's needs.

To get a sense for the vision of this project, see the high-level architecture diagram below.

image::https://github.com/stargate/stargate/blob/master/assets/stargate-arch-high-level.png?raw=true[Stargate High-Level Architecture]

== Project Architecture

Stargate is broken up into modules that fit into the broad categories of API Extensions, Persistence Extensions, and Authentication Extensions.

The diagram below shows how these modules fit together.

image::https://github.com/stargate/stargate/blob/master/assets/stargate-modules-preview-version.png?raw=true[Stargate High-Level Architecture]

=== API Extensions
API Extensions are responsible for defining the API, handling and converting requests to database queries, dispatching to persistence services, and returning and serving response to clients.

There are currently extensions for the Cassandra Query Language (CQL)
and a REST API for CRUD access to data in tables with many more coming soon.
These extensions use both the Authentication Services and the Persistence Services.

The REST API for example uses the https://github.com/stargate/stargate/tree/master/auth-api[auth-api] to handle token access
to the endpoints that are exposed by the Jetty-based Web Server.
The https://github.com/stargate/stargate/tree/master/persistence-api[persistence-api] is used to dispatch converted
requests to the underlying storage engine.
In the case of the REST API, you can see what this looks like in the https://github.com/stargate/stargate/blob/master/restapi/src/main/java/io/stargate/web/resources/v2/RowsResource.java[RowsResource].


=== Persistence Extensions
Persistence Extensions are responsible for implementing the coordination layer to execute requests
passed by API services to underlying data storage instances.

The persistence extensions are very Cassandra-centric in the current form of the project as this is the first database that
we chose to implement. The extensions for Cassandra 3.11 and 4.0 use Cassandra's coordinator concept and code to do the majority of the work.

Specifically, when using Stargate with one of these extensions,
they join the Cassandra ring as https://cassandra.apache.org/doc/latest/architecture/dynamo.html[coordinator node] (does not store data),
mock Cassandra system tables for native driver integration,
execute requests with Cassandra storage instances using Cassandra's internal QueryHandler / QueryProcessor,
and convert internal Cassandra objects and ResultSets to Stargate Datastore objects.

=== Authentication Extensions

Authentication Extensions are responsible for the access control to Stargate's APIs.

Currently there only exists a https://github.com/stargate/stargate/tree/master/auth-table-based-service[auth-table-based-service] which stores generated access tokens in the database.

These extensions are used by the API Extensions to federate access.
You can see an example of this in the https://github.com/stargate/stargate/tree/master/restapi[REST API] which requires a token to be passed to requests using the
`X-Cassandra-Token` header.